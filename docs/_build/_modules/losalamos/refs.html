<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>losalamos.refs &#8212; losalamos v.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css?v=2bf1fcf8" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    
    <script src="../../_static/documentation_options.js?v=fb9c8d0f"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">losalamos v.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">losalamos.refs</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for losalamos.refs</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Classes for parsing, handling and managing references</span>

<span class="sd">Description:</span>
<span class="sd">    The ``refs`` module provides classes for parsing, handling and managing references</span>

<span class="sd">License:</span>
<span class="sd">    This software is released under the GNU General Public License v3.0 (GPL-3.0).</span>
<span class="sd">    For details, see: https://www.gnu.org/licenses/gpl-3.0.html</span>

<span class="sd">Author:</span>
<span class="sd">    Ipor√£ Possantti</span>

<span class="sd">Contact:</span>
<span class="sd">    possantti@gmail.com</span>


<span class="sd">Overview</span>
<span class="sd">--------</span>

<span class="sd">todo</span>
<span class="sd">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</span>
<span class="sd">Nulla mollis tincidunt erat eget iaculis.</span>
<span class="sd">Mauris gravida ex quam, in porttitor lacus lobortis vitae.</span>
<span class="sd">In a lacinia nisl. Pellentesque habitant morbi tristique senectus</span>
<span class="sd">et netus et malesuada fames ac turpis egestas.</span>

<span class="sd">Class aptent taciti sociosqu ad litora torquent per</span>
<span class="sd">conubia nostra, per inceptos himenaeos. Nulla facilisi. Mauris eget nisl</span>
<span class="sd">eu eros euismod sodales. Cras pulvinar tincidunt enim nec semper.</span>


<span class="sd">Examples</span>
<span class="sd">--------</span>

<span class="sd">todo</span>
<span class="sd">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</span>
<span class="sd">Nulla mollis tincidunt erat eget iaculis.</span>
<span class="sd">Mauris gravida ex quam, in porttitor lacus lobortis vitae.</span>
<span class="sd">In a lacinia nisl. Pellentesque habitant morbi tristique senectus</span>
<span class="sd">et netus et malesuada fames ac turpis egestas.</span>

<span class="sd">Class aptent taciti sociosqu ad litora torquent per</span>
<span class="sd">conubia nostra, per inceptos himenaeos. Nulla facilisi. Mauris eget nisl</span>
<span class="sd">eu eros euismod sodales. Cras pulvinar tincidunt enim nec semper.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">filedialog</span>

<span class="kn">import</span> <span class="nn">requests</span>

<span class="kn">from</span> <span class="nn">losalamos.root</span> <span class="kn">import</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">MbaE</span><span class="p">,</span> <span class="n">Note</span>


<div class="viewcode-block" id="RefForm">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm">[docs]</a>
<span class="k">class</span> <span class="nc">RefForm</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">):</span>
    <span class="c1"># todo evaluate move or rebase</span>

<div class="viewcode-block" id="RefForm.__init__">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib_folder</span><span class="p">,</span> <span class="n">inp_folder</span><span class="p">,</span> <span class="n">kind_opts</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Add References&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&quot;550x450&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_lib_def</span> <span class="o">=</span> <span class="n">lib_folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_inp_def</span> <span class="o">=</span> <span class="n">inp_folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options_def</span> <span class="o">=</span> <span class="n">kind_opts</span><span class="p">[:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">form_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_widgets</span><span class="p">()</span></div>


<div class="viewcode-block" id="RefForm.create_widgets">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.create_widgets">[docs]</a>
    <span class="k">def</span> <span class="nf">create_widgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Output folder</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Library Folder:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_lib</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_lib</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_lib</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder_lib_def</span><span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Browse&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_folder_lib</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span>
        <span class="p">)</span>

        <span class="c1"># Input folder</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Input Folder:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_inp</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_inp</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">folder_inp</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder_inp_def</span><span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Browse&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">browse_folder_inp</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span>
        <span class="p">)</span>

        <span class="c1"># Kind of input</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Entry type:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kind_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kind_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;paper&quot;</span><span class="p">)</span>  <span class="c1"># default value</span>
        <span class="n">kind_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options_def</span><span class="p">[:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kind_menu</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind_var</span><span class="p">,</span> <span class="o">*</span><span class="n">kind_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kind_menu</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>

        <span class="c1"># Tags</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Tags:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tags_listbox</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Listbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selectmode</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tags_listbox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tags_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tags_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Add&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">add_tag</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remove&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_tag</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Related notes</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Related:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">related_listbox</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Listbox</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">selectmode</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">3</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">related_listbox</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">related_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">related_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Add&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">add_related</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Remove&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">remove_related</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Include BIB file</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Include BibTeX:&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">include_bib</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">include_bib</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s2">&quot;w&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Submit button</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Submit&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">submit_form</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">20</span>
        <span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&quot;Cancel&quot;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cancel_form</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span>
            <span class="n">row</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">20</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="RefForm.browse_folder_lib">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.browse_folder_lib">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_folder_lib</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askdirectory</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">folder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">folder_lib</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">folder_lib</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span></div>


<div class="viewcode-block" id="RefForm.browse_folder_inp">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.browse_folder_inp">[docs]</a>
    <span class="k">def</span> <span class="nf">browse_folder_inp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">folder</span> <span class="o">=</span> <span class="n">filedialog</span><span class="o">.</span><span class="n">askdirectory</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">folder</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">folder_inp</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">folder_inp</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">folder</span><span class="p">)</span></div>


<div class="viewcode-block" id="RefForm.covert_entry_to_list">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.covert_entry_to_list">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">covert_entry_to_list</span><span class="p">(</span><span class="n">entry_str</span><span class="p">):</span>
        <span class="c1"># todo evaluate move</span>
        <span class="c1"># replace commas</span>
        <span class="n">entry_str</span> <span class="o">=</span> <span class="n">entry_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="n">entry_str</span> <span class="o">=</span> <span class="n">entry_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="c1"># drop hashs</span>
        <span class="n">entry_str</span> <span class="o">=</span> <span class="n">entry_str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="c1"># get list</span>
        <span class="n">entry_ls</span> <span class="o">=</span> <span class="n">entry_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
        <span class="n">entry_ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">entry_ls</span><span class="p">]</span>
        <span class="c1"># remove duplicates</span>
        <span class="n">entry_ls</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">entry_ls</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">entry_ls</span></div>


<div class="viewcode-block" id="RefForm.add_tag">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.add_tag">[docs]</a>
    <span class="k">def</span> <span class="nf">add_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags_entry</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">tag</span><span class="p">:</span>
            <span class="n">tag_ls</span> <span class="o">=</span> <span class="n">RefForm</span><span class="o">.</span><span class="n">covert_entry_to_list</span><span class="p">(</span><span class="n">entry_str</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
            <span class="n">tag_ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tag_ls</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tag_ls</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tags_listbox</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tags_entry</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span></div>


<div class="viewcode-block" id="RefForm.remove_tag">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.remove_tag">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_tag</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selected_tag_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tags_listbox</span><span class="o">.</span><span class="n">curselection</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selected_tag_index</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tags_listbox</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">selected_tag_index</span><span class="p">)</span></div>


<div class="viewcode-block" id="RefForm.add_related">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.add_related">[docs]</a>
    <span class="k">def</span> <span class="nf">add_related</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">related_note</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_entry</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">related_note</span><span class="p">:</span>
            <span class="n">rel_ls</span> <span class="o">=</span> <span class="n">RefForm</span><span class="o">.</span><span class="n">covert_entry_to_list</span><span class="p">(</span><span class="n">entry_str</span><span class="o">=</span><span class="n">related_note</span><span class="p">)</span>
            <span class="n">rel_ls</span> <span class="o">=</span> <span class="p">[</span><span class="n">related_note</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">related_note</span> <span class="ow">in</span> <span class="n">rel_ls</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">related_note</span> <span class="ow">in</span> <span class="n">rel_ls</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">related_listbox</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;[[</span><span class="si">{</span><span class="n">related_note</span><span class="si">}</span><span class="s2">]]&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">related_entry</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">)</span></div>


<div class="viewcode-block" id="RefForm.remove_related">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.remove_related">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_related</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">selected_related_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">related_listbox</span><span class="o">.</span><span class="n">curselection</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">selected_related_index</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">related_listbox</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">selected_related_index</span><span class="p">)</span></div>


<div class="viewcode-block" id="RefForm.submit_form">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.submit_form">[docs]</a>
    <span class="k">def</span> <span class="nf">submit_form</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">folder_lib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder_lib</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">folder_inp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">folder_inp</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">kind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tags_listbox</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">))</span>
        <span class="n">related</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">related_listbox</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tk</span><span class="o">.</span><span class="n">END</span><span class="p">))</span>
        <span class="n">include_bib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">include_bib</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">form_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;folder_lib&quot;</span><span class="p">:</span> <span class="n">folder_lib</span><span class="p">,</span>
            <span class="s2">&quot;folder_inp&quot;</span><span class="p">:</span> <span class="n">folder_inp</span><span class="p">,</span>
            <span class="s2">&quot;kind&quot;</span><span class="p">:</span> <span class="n">kind</span><span class="p">,</span>
            <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="n">tags</span><span class="p">,</span>
            <span class="s2">&quot;related&quot;</span><span class="p">:</span> <span class="n">related</span><span class="p">,</span>
            <span class="s2">&quot;include_bib&quot;</span><span class="p">:</span> <span class="n">include_bib</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>  <span class="c1"># Close the Tkinter window</span></div>


<div class="viewcode-block" id="RefForm.cancel_form">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.cancel_form">[docs]</a>
    <span class="k">def</span> <span class="nf">cancel_form</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">form_data</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span></div>


<div class="viewcode-block" id="RefForm.get_form_data">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefForm.get_form_data">[docs]</a>
    <span class="k">def</span> <span class="nf">get_form_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">form_data</span></div>
</div>



<div class="viewcode-block" id="Ref">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref">[docs]</a>
<span class="k">class</span> <span class="nc">Ref</span><span class="p">(</span><span class="n">MbaE</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The core reference object for managing documents and citations.</span>

<span class="sd">    **Examples:**</span>

<span class="sd">    Here&#39;s how to use the ``Ref`` class:</span>

<span class="sd">    Import Ref</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        # Import Ref</span>
<span class="sd">        from losalamos.refs import Ref</span>

<span class="sd">    Parse Bib Files</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        # Use built-in static method for parsing `bib` files:</span>
<span class="sd">        lst_bibs = Ref.parse_bibtex(file_note=&quot;./refs.bib&quot;)</span>
<span class="sd">        for bib_dict in lst_bibs:</span>
<span class="sd">            print(&quot;-------&quot;)</span>
<span class="sd">            # use method for standardize authors</span>
<span class="sd">            bib_dict[&quot;author&quot;] = Ref.standard_author(bib_dict=bib_dict)</span>

<span class="sd">            # built-in static method for getting in-text citation</span>
<span class="sd">            c = Ref.cite_intext(</span>
<span class="sd">                bib_dict=bib_dict,</span>
<span class="sd">                text_format=&#39;md&#39; # markup format</span>
<span class="sd">            )</span>
<span class="sd">            print(c)</span>
<span class="sd">            # built-in static method for getting full citations</span>
<span class="sd">            c = Ref.cite_full(</span>
<span class="sd">                bib_dict=bib_dict,</span>
<span class="sd">                style=&quot;apa&quot;, # APA format</span>
<span class="sd">                text_format=&#39;tex&#39;,  # markup format</span>
<span class="sd">                entry_type=bib_dict[&quot;entry_type&quot;]</span>
<span class="sd">            )</span>
<span class="sd">            print(c)</span>


<span class="sd">    Instantiate a Reference</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        # Instantiante a reference</span>
<span class="sd">        r = Ref(</span>
<span class="sd">            entry_type=&quot;book&quot;,</span>
<span class="sd">            title=&quot;The Origin of Species&quot;,</span>
<span class="sd">            author=&quot;Charles Darwin&quot;,</span>
<span class="sd">            year=&quot;1859&quot;,</span>
<span class="sd">            citation_key=&quot;darwin1859&quot;</span>
<span class="sd">        )</span>

<span class="sd">    Set Reference by Incoming Dict</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        # (Re)Set reference by incoming dict:</span>
<span class="sd">        r.set(</span>
<span class="sd">            dict_setter={</span>
<span class="sd">                &quot;entry_type&quot;: &quot;article&quot;,</span>
<span class="sd">                &quot;title&quot;: &quot;Views of Nature&quot;</span>
<span class="sd">                &quot;author&quot;: &quot;Alexander von Humboldt&quot;,</span>
<span class="sd">                &quot;year&quot;: &quot;1794&quot;,</span>
<span class="sd">                &quot;citation_key&quot;: &quot;humboldt1793&quot;,</span>
<span class="sd">            }</span>
<span class="sd">        )</span>

<span class="sd">    Load Reference from BibTeX File</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        # Load reference from `bib` file:</span>
<span class="sd">        # set order=0 for the first reference</span>
<span class="sd">        r.load_bib(file_note=&quot;./beven1989.bib&quot;, order=0)</span>

<span class="sd">    Search/Update bib info via CrossRef API</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        r.bib_dict = Ref.search_info(</span>
<span class="sd">            bib_dict=r.bib_dict, # bib entry</span>
<span class="sd">            update=True, # default False</span>
<span class="sd">            fields=[&quot;doi&quot;, &quot;journal&quot;, &quot;url&quot;, &quot;publisher&quot;],  # Selected fields</span>
<span class="sd">            search_query=&quot;Beven 1989 changing ideas&quot; # Default is the full-citation</span>
<span class="sd">        )</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Ref.__init__">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">entry_type</span><span class="o">=</span><span class="s2">&quot;book&quot;</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;The Origin of Species&quot;</span><span class="p">,</span>
        <span class="n">author</span><span class="o">=</span><span class="s2">&quot;Darwin, C&quot;</span><span class="p">,</span>
        <span class="n">year</span><span class="o">=</span><span class="s2">&quot;1859&quot;</span><span class="p">,</span>
        <span class="n">citation_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the `Ref` object</span>

<span class="sd">        :param entry_type: reference entry_type in BibTeX convetion (e.g., article, book, etc)</span>
<span class="sd">        :entry_type entry_type: str</span>
<span class="sd">        :param title: main title of the reference</span>
<span class="sd">        :entry_type title: str</span>
<span class="sd">        :param author: author(s) filename(s)</span>
<span class="sd">        :entry_type author: str</span>
<span class="sd">        :param year: year of publication</span>
<span class="sd">        :entry_type year: str</span>
<span class="sd">        :param citation_key: citation key of the reference</span>
<span class="sd">        :entry_type citation_key: str</span>
<span class="sd">        :param file_note: path to BibTeX file</span>
<span class="sd">        :entry_type file_note: str</span>
<span class="sd">        :param file_note: path to markdown note</span>
<span class="sd">        :entry_type file_note: str</span>
<span class="sd">        :param file_doc: path to pdf document</span>
<span class="sd">        :entry_type file_doc: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set basic attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_type</span> <span class="o">=</span> <span class="n">entry_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">citation_key</span> <span class="o">=</span> <span class="n">citation_key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">author</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
        <span class="c1"># file paths</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_bib</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_note</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_doc</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lib_folder</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># bib dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># note class</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">note</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">note_comments</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">note_tags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">note_related</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">references_list</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># filename and alias setup</span>
        <span class="n">_name</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">cite_intext</span><span class="p">(</span>
            <span class="n">bib_dict</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="p">,</span> <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">},</span> <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">citation_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">citation_key</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_alias</span> <span class="o">=</span> <span class="s2">&quot;MRef&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">_name</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="n">_alias</span><span class="p">)</span></div>

        <span class="c1"># ... continues in downstream objects ... #</span>

<div class="viewcode-block" id="Ref._set_fields">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref._set_fields">[docs]</a>
    <span class="k">def</span> <span class="nf">_set_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set fields names&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_set_fields</span><span class="p">()</span>
        <span class="c1"># Attribute fields</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">citation_key_field</span> <span class="o">=</span> <span class="s2">&quot;citation_key&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type_field</span> <span class="o">=</span> <span class="s2">&quot;entry_type&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_field</span> <span class="o">=</span> <span class="s2">&quot;title&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author_field</span> <span class="o">=</span> <span class="s2">&quot;author&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year_field</span> <span class="o">=</span> <span class="s2">&quot;year&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_bib_field</span> <span class="o">=</span> <span class="s2">&quot;file_bib&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_note_field</span> <span class="o">=</span> <span class="s2">&quot;file_note&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_doc_field</span> <span class="o">=</span> <span class="s2">&quot;file_doc&quot;</span></div>

        <span class="c1"># Metadata fields</span>

        <span class="c1"># ... continues in downstream objects ... #</span>

<div class="viewcode-block" id="Ref.get_metadata">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.get_metadata">[docs]</a>
    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a dictionary with object metadata.</span>
<span class="sd">        Expected to increment superior methods.</span>

<span class="sd">        .. note::</span>

<span class="sd">            Metadata does **not** necessarily inclue all object attributes.</span>

<span class="sd">        :return: dictionary with all metadata</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># ------------ call super ----------- #</span>
        <span class="n">dict_meta</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">()</span>

        <span class="c1"># customize local metadata:</span>
        <span class="n">dict_meta_local</span> <span class="o">=</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">type_field</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry_type</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">citation_key_field</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">citation_key</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title_field</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">author_field</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">year_field</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_bib_field</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_bib</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_note_field</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_note</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_doc_field</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_doc</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1"># update</span>
        <span class="n">dict_meta</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dict_meta_local</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dict_meta</span></div>


<div class="viewcode-block" id="Ref.set">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.set">[docs]</a>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_setter</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set selected attributes based on an incoming dictionary</span>

<span class="sd">        :param dict_setter: incoming dictionary with attribute values</span>
<span class="sd">        :entry_type dict_setter: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># handle potentially missing fields</span>
        <span class="n">list_dict_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dict_setter</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="c1"># this is because of a very weird bug in the parsing process</span>
        <span class="n">dict_setter_stripped</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">list_dict_keys</span><span class="p">:</span>
            <span class="n">dict_setter_stripped</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_setter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">dict_setter</span> <span class="o">=</span> <span class="n">dict_setter_stripped</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># filename</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_dict_keys</span><span class="p">:</span>
            <span class="c1"># set as citation in-text</span>
            <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">cite_intext</span><span class="p">(</span>
                <span class="n">bib_dict</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">author_field</span><span class="p">],</span>
                    <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">year_field</span><span class="p">],</span>
                <span class="p">},</span>
                <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># alias</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">alias_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_dict_keys</span><span class="p">:</span>
            <span class="c1"># set as citation key</span>
            <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">alias_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">citation_key_field</span><span class="p">]</span>
        <span class="c1"># file_note</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_bib_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_dict_keys</span><span class="p">:</span>
            <span class="c1"># set as none</span>
            <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">file_bib_field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_bib</span>
        <span class="c1"># file_note</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_note_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_dict_keys</span><span class="p">:</span>
            <span class="c1"># set as none</span>
            <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">file_note_field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_note</span>
        <span class="c1"># file_doc</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_doc_field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">list_dict_keys</span><span class="p">:</span>
            <span class="c1"># set as none</span>
            <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">file_doc_field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_doc</span>

        <span class="c1"># ---------- set basic attributes --------- #</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">dict_setter</span><span class="o">=</span><span class="n">dict_setter</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry_type</span> <span class="o">=</span> <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type_field</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">citation_key</span> <span class="o">=</span> <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">citation_key_field</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">title_field</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">author_field</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">year_field</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_note</span> <span class="o">=</span> <span class="n">dict_setter</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">file_note_field</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_doc</span> <span class="o">=</span> <span class="n">dict_setter</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_doc_field</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span></div>


        <span class="c1"># ... continues in downstream objects ... #</span>

<div class="viewcode-block" id="Ref.load_bib">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.load_bib">[docs]</a>
    <span class="k">def</span> <span class="nf">load_bib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load reference from ``bib`` file.</span>

<span class="sd">        :param order: order number in the ``bib`` file (first = 0)</span>
<span class="sd">        :entry_type order: int</span>
<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_refs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_bibtex</span><span class="p">(</span><span class="n">file_bib</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_bib</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span> <span class="o">=</span> <span class="n">list_refs</span><span class="p">[</span><span class="n">order</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">dict_setter</span><span class="o">=</span><span class="n">list_refs</span><span class="p">[</span><span class="n">order</span><span class="p">])</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Ref.load_note">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.load_note">[docs]</a>
    <span class="k">def</span> <span class="nf">load_note</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads a note and assigns it to the instance variable.</span>

<span class="sd">        This method initializes a RefNote object with the instance&#39;s name and alias,</span>
<span class="sd">        sets its file_note attribute, and then calls the load method on the RefNote object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">note</span> <span class="o">=</span> <span class="n">RefNote</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alias</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">note</span><span class="o">.</span><span class="n">file_note</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_note</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">note</span><span class="o">.</span><span class="n">load</span><span class="p">()</span></div>


<div class="viewcode-block" id="Ref.standardize">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.standardize">[docs]</a>
    <span class="k">def</span> <span class="nf">standardize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Standardize citation key, author formatting</span>

<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">conflict_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lib_folder</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_folder</span><span class="p">):</span>
                <span class="n">conflict_list</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">get_citation_keys</span><span class="p">(</span><span class="n">lib_folder</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_folder</span><span class="p">)</span>

        <span class="c1"># set standard author</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">author</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">standard_author</span><span class="p">(</span><span class="n">bib_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">author_field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">author</span>

        <span class="c1"># set standard citation key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">citation_key</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">standard_key</span><span class="p">(</span>
            <span class="n">bib_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">conflict_list</span><span class="o">=</span><span class="n">conflict_list</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">citation_key_field</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">citation_key</span>

        <span class="c1"># Name and Alias</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">cite_intext</span><span class="p">(</span><span class="n">bib_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">citation_key</span></div>


<div class="viewcode-block" id="Ref.save_bib">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.save_bib">[docs]</a>
    <span class="k">def</span> <span class="nf">save_bib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save bibliography to bib file (default to bib_file attribute).</span>
<span class="sd">        Ref is expected to hold the bib_dict</span>

<span class="sd">        :param output_dir: the directory where the ``bib`` file will be saved.</span>
<span class="sd">        :entry_type output_dir: str</span>
<span class="sd">        :param filename: the name of the .bib file (without extension).</span>
<span class="sd">        :entry_type filename: str</span>
<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># handle output</span>
        <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_bib</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_bib</span><span class="p">))</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># Export</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">to_bib</span><span class="p">(</span>
            <span class="n">bib_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_bib</span> <span class="o">=</span> <span class="n">file_path</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Ref.to_note">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.to_note">[docs]</a>
    <span class="k">def</span> <span class="nf">to_note</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="p">,</span>
        <span class="n">note_template</span><span class="p">,</span>
        <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">body</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">related</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">references</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">pdf_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts the current reference to a note and saves it to a file.</span>

<span class="sd">        :param output_dir: The directory where the note file will be saved.</span>
<span class="sd">        :type output_dir: str</span>
<span class="sd">        :param filename: The name of the note file to be created.</span>
<span class="sd">        :type filename: str</span>
<span class="sd">        :param body: Optional body of the note to include in the note.</span>
<span class="sd">        :type body: list or None</span>
<span class="sd">        :param tags: Optional tags associated with the note.</span>
<span class="sd">        :type tags: list or None</span>
<span class="sd">        :param related: Optional related references.</span>
<span class="sd">        :type related: list or None</span>
<span class="sd">        :param references: Optional references to include in the note.</span>
<span class="sd">        :type references: list or None</span>
<span class="sd">        :param pdf_name: Optional PDF file name</span>
<span class="sd">        :type pdf_name: str or None</span>
<span class="sd">        :return: The path to the saved note file.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

        <span class="c1"># get note</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">RefNote</span><span class="p">()</span>
        <span class="n">n</span><span class="o">.</span><span class="n">file_note</span> <span class="o">=</span> <span class="n">note_template</span>
        <span class="c1"># load template data</span>
        <span class="n">n</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
        <span class="c1"># set incoming data for the body</span>
        <span class="k">if</span> <span class="n">body</span><span class="p">:</span>
            <span class="n">n</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span><span class="p">[:]</span>
        <span class="c1"># update metadata with bib</span>
        <span class="n">n</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
        <span class="n">n</span><span class="o">.</span><span class="n">_standardize_metatada</span><span class="p">()</span>

        <span class="c1"># handle tags</span>
        <span class="k">if</span> <span class="n">tags</span><span class="p">:</span>
            <span class="c1"># merge with template standard tags</span>
            <span class="n">n</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tags</span> <span class="o">+</span> <span class="n">n</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">]))</span>

        <span class="c1"># compute timestamp</span>
        <span class="n">_now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">n</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;timestamp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M&quot;</span><span class="p">)</span>

        <span class="c1"># set citation in</span>
        <span class="n">citation_in</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">cite_intext</span><span class="p">(</span>
            <span class="n">bib_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span>
        <span class="p">)</span>
        <span class="n">n</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;citation_in&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">citation_in</span>

        <span class="c1"># set PDF file field</span>
        <span class="k">if</span> <span class="n">pdf_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># use citation key</span>
            <span class="n">pdf_name</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;citation_key&quot;</span><span class="p">]</span>
        <span class="n">n</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&quot;[[</span><span class="si">{}</span><span class="s1">.pdf]]&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pdf_name</span><span class="p">)</span>

        <span class="c1"># handle data</span>
        <span class="n">n</span><span class="o">.</span><span class="n">update_data</span><span class="p">(</span><span class="n">related_list</span><span class="o">=</span><span class="n">related</span><span class="p">)</span>

        <span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">.md&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">n</span><span class="o">.</span><span class="n">file_note</span> <span class="o">=</span> <span class="n">output_file</span>
        <span class="n">n</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">output_file</span></div>


<div class="viewcode-block" id="Ref.add_to_lib">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.add_to_lib">[docs]</a>
    <span class="k">def</span> <span class="nf">add_to_lib</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">lib_folder</span><span class="p">,</span>
        <span class="n">note_template</span><span class="p">,</span>
        <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">related</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">comments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">pdf_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">note_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds the current item to the specified library folder.</span>

<span class="sd">        :param lib_folder: The path to the library folder where the item will be added.</span>
<span class="sd">        :type lib_folder: str</span>
<span class="sd">        :param tags: Optional tags associated with the item.</span>
<span class="sd">        :type tags: list or None</span>
<span class="sd">        :param related: Optional related items.</span>
<span class="sd">        :type related: list or None</span>
<span class="sd">        :param comments: Optional body about the item.</span>
<span class="sd">        :type comments: str or None</span>
<span class="sd">        :param pdf_name: Optional PDF file name</span>
<span class="sd">        :type pdf_name: str or None</span>
<span class="sd">        :param note_name: Optional note file name</span>
<span class="sd">        :type note_name: str or None</span>
<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># update lib folder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lib_folder</span> <span class="o">=</span> <span class="n">lib_folder</span>

        <span class="c1"># Standardize citation key</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">standardize</span><span class="p">()</span>

        <span class="c1"># export pdf</span>
        <span class="k">if</span> <span class="n">pdf_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;article&quot;</span><span class="p">:</span>
                <span class="n">pdf_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;citation_key&quot;</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;thesis&quot;</span><span class="p">:</span>
                <span class="n">author_full</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">pdf_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">author_full</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pdf_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
        <span class="n">dst_pdf</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">.pdf&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_folder</span><span class="p">,</span> <span class="n">pdf_name</span><span class="p">)</span>
        <span class="c1"># copy to libfolder</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">file_doc</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="n">dst_pdf</span><span class="p">)</span>  <span class="c1"># expected to be defined</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Added PDF file: </span><span class="si">{</span><span class="n">dst_pdf</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># export note</span>
        <span class="k">if</span> <span class="n">note_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># paper is the ckey</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;article&quot;</span><span class="p">:</span>
                <span class="n">note_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;citation_key&quot;</span><span class="p">]</span>
            <span class="c1"># thesis is the author (year) name</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;thesis&quot;</span><span class="p">:</span>
                <span class="n">author_full</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">note_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">author_full</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
            <span class="c1"># else</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">note_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>

        <span class="c1"># get note now</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_note</span><span class="p">(</span>
            <span class="n">output_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lib_folder</span><span class="p">,</span>
            <span class="n">note_template</span><span class="o">=</span><span class="n">note_template</span><span class="p">,</span>
            <span class="n">filename</span><span class="o">=</span><span class="n">note_name</span><span class="p">,</span>
            <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
            <span class="n">related</span><span class="o">=</span><span class="n">related</span><span class="p">,</span>
            <span class="n">body</span><span class="o">=</span><span class="n">comments</span><span class="p">,</span>
            <span class="n">pdf_name</span><span class="o">=</span><span class="n">pdf_name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Added Markdown note: </span><span class="si">{</span><span class="n">o</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Handle cover</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;book&quot;</span><span class="p">,</span> <span class="s2">&quot;techreport&quot;</span><span class="p">]:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">RefNote</span><span class="o">.</span><span class="n">get_cover_image</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="n">dst_pdf</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Added cover file: </span><span class="si">{</span><span class="n">im</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Ref.to_bib">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.to_bib">[docs]</a>
    <span class="k">def</span> <span class="nf">to_bib</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates a .bib file from the current item&#39;s data and saves it to the specified directory.</span>

<span class="sd">        :param output_dir: The directory where the .bib file will be saved.</span>
<span class="sd">        :type output_dir: str</span>
<span class="sd">        :param filename: The name of the .bib file to be created.</span>
<span class="sd">        :type filename: str</span>
<span class="sd">        :return: The path to the saved .bib file.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bibtex_content</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;@</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type_field</span><span class="p">]</span><span class="si">}</span><span class="se">{{</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">citation_key_field</span><span class="p">]</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bib_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type_field</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">citation_key_field</span><span class="p">]:</span>
                <span class="n">bibtex_content</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="se">{{</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">}}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">bibtex_content</span> <span class="o">=</span> <span class="n">bibtex_content</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="c1"># write file</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">.bib&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bib_file</span><span class="p">:</span>
            <span class="n">bib_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bibtex_content</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">file_path</span></div>


<div class="viewcode-block" id="Ref.get_citation_keys">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.get_citation_keys">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_citation_keys</span><span class="p">(</span><span class="n">lib_folder</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the list of citations key from a library folder.</span>
<span class="sd">        The folder is expected to hold references in md files named by</span>
<span class="sd">        the respective citations keys.</span>
<span class="sd">        The &quot;_&quot; is considered a flag for md files not related to the reference.</span>

<span class="sd">        :param lib_folder: path to library directory</span>
<span class="sd">        :type lib_folder: str</span>
<span class="sd">        :return: list of names of citation keys</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># List to hold the filtered filenames</span>
        <span class="n">filtered_files</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Iterate through all files in the directory</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">lib_folder</span><span class="p">):</span>
            <span class="c1"># Check if the file has a &quot;.md&quot; extension and does not contain the &quot;_&quot; character</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.md&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;_&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
                <span class="n">filtered_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">filtered_files</span></div>


<div class="viewcode-block" id="Ref.bibstr_to_dict">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.bibstr_to_dict">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">bibstr_to_dict</span><span class="p">(</span><span class="n">bibtex_str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts a BibTeX string into a dictionary representation.</span>

<span class="sd">        :param bibtex_str: The BibTeX string to convert.</span>
<span class="sd">        :type bibtex_str: str</span>
<span class="sd">        :return: A dictionary with the BibTeX entry&#39;s type, citation key, and fields.</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Regular expression patterns</span>
        <span class="n">entry_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;@\w+\{&quot;</span><span class="p">)</span>
        <span class="n">key_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;@\w+\{(.+?),&quot;</span><span class="p">)</span>
        <span class="n">field_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(\w+)\s*=\s*[{&quot;](.*?)[}&quot;],?&#39;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>

        <span class="c1"># Extract entry type and citation key</span>
        <span class="n">entry_type_match</span> <span class="o">=</span> <span class="n">entry_pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">bibtex_str</span><span class="p">)</span>
        <span class="n">key_match</span> <span class="o">=</span> <span class="n">key_pattern</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">bibtex_str</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry_type_match</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">key_match</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid BibTeX entry format&quot;</span><span class="p">)</span>

        <span class="n">entry_type</span> <span class="o">=</span> <span class="n">entry_type_match</span><span class="o">.</span><span class="n">group</span><span class="p">()[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">citation_key</span> <span class="o">=</span> <span class="n">key_match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Create the dictionary with initial keys</span>
        <span class="n">bib_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;entry_type&quot;</span><span class="p">:</span> <span class="n">entry_type</span><span class="p">,</span> <span class="s2">&quot;citation_key&quot;</span><span class="p">:</span> <span class="n">citation_key</span><span class="p">}</span>

        <span class="c1"># Extract fields</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">field_pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">bibtex_str</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">field</span>
            <span class="n">bib_dict</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">bib_dict</span></div>


<div class="viewcode-block" id="Ref.parse_bibtex">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.parse_bibtex">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">parse_bibtex</span><span class="p">(</span><span class="n">file_bib</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse a ``bib`` file and return a list of references as dictionaries.</span>

<span class="sd">        :param file_bib: Path to the ``bib`` file.</span>
<span class="sd">        :return: A list of dictionaries, each representing a BibTeX bib_dict.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">entries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_bib</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

                <span class="c1"># Ignore empty lines and body</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span> <span class="ow">or</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;%&quot;</span><span class="p">):</span>
                    <span class="k">continue</span>

                <span class="c1"># New bib_dict starts</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="c1"># Extracting the entry_type and citation key</span>
                    <span class="n">entry_type</span><span class="p">,</span> <span class="n">citation_key</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry_type</span>
                    <span class="n">entry</span><span class="p">[</span><span class="s2">&quot;citation_key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">citation_key</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">elif</span> <span class="s2">&quot;=&quot;</span> <span class="ow">in</span> <span class="n">line</span> <span class="ow">and</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># Extracting the field key and value</span>
                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span>
                    <span class="n">entry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">elif</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">key</span><span class="p">:</span>
                    <span class="c1"># Continuation of a field value in a new line</span>
                    <span class="n">entry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;}&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

        <span class="c1"># Add the last bib_dict if it exists</span>
        <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># ensure values are stripped:</span>
            <span class="n">entry_new</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                <span class="n">entry_new</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">entries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry_new</span><span class="p">)</span>

        <span class="n">stripped_data</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">entries</span>
        <span class="p">]</span>

        <span class="k">return</span> <span class="n">stripped_data</span></div>


<div class="viewcode-block" id="Ref.cite_intext">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.cite_intext">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cite_intext</span><span class="p">(</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">,</span> <span class="n">embed_link</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format a dictionary of bibliometric parameters into an in-text citation string with optional DOI or URL links.</span>

<span class="sd">        :param bib_dict: dict</span>
<span class="sd">            A dictionary containing bibliometric parameters from a reference.</span>
<span class="sd">            Expected keys include &#39;author&#39;, &#39;year&#39;, &#39;doi&#39;, and &#39;url&#39;.</span>
<span class="sd">        :param text_format: str</span>
<span class="sd">            The text format for styling (e.g., &#39;plain&#39;, &#39;html&#39;, &#39;md&#39;, &#39;tex&#39;).</span>
<span class="sd">        :param embed_link: bool</span>
<span class="sd">            Whether to embed a DOI or URL link in the citation (default is False).</span>
<span class="sd">        :return: str</span>
<span class="sd">            The formatted in-text citation string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Assume it is normalized</span>
        <span class="c1"># bib_dict[&quot;author&quot;] = Ref.standard_author(bib_dict)</span>

        <span class="c1"># Using dictionary comprehension</span>
        <span class="n">bib_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="p">(</span><span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="n">author</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;author&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown Author&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;n.d.&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">doi</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;doi&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># Split and prepare author names for in-text citation</span>
        <span class="n">author_list</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)</span>
        <span class="n">first_author_lastname</span> <span class="o">=</span> <span class="n">author_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">author_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">formatted_authors</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">first_author_lastname</span><span class="si">}</span><span class="s2"> et al.&quot;</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">author_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">second_author_lastname</span> <span class="o">=</span> <span class="n">author_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">formatted_authors</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">first_author_lastname</span><span class="si">}</span><span class="s2"> &amp; </span><span class="si">{</span><span class="n">second_author_lastname</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">formatted_authors</span> <span class="o">=</span> <span class="n">first_author_lastname</span>

        <span class="c1"># Apply text formatting</span>
        <span class="k">def</span> <span class="nf">apply_format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">text_format</span><span class="p">):</span>
            <span class="c1"># todo evaluate move this to an editor class</span>
            <span class="n">formatted</span> <span class="o">=</span> <span class="n">text</span><span class="p">[:]</span>
            <span class="k">if</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;plain&quot;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;html&quot;</span><span class="p">:</span>
                <span class="n">formatted</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;et al.&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;i&gt;et al.&lt;/i&gt;&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;md&quot;</span><span class="p">:</span>
                <span class="n">formatted</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;et al.&quot;</span><span class="p">,</span> <span class="s2">&quot;*et al.*&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;tex&quot;</span><span class="p">:</span>
                <span class="n">formatted</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;et al.&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\textit{et al.}&quot;</span><span class="p">)</span>
                <span class="n">formatted</span> <span class="o">=</span> <span class="n">formatted</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&amp;&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;\&amp;&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">formatted</span>

        <span class="n">formatted_authors</span> <span class="o">=</span> <span class="n">apply_format</span><span class="p">(</span><span class="n">formatted_authors</span><span class="p">,</span> <span class="n">text_format</span><span class="p">)</span>

        <span class="c1"># Embed link if applicable</span>
        <span class="k">def</span> <span class="nf">embed_link_func</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">text_format</span><span class="p">,</span> <span class="n">link</span><span class="p">):</span>
            <span class="c1"># todo evaluate move this to an editor class</span>
            <span class="k">if</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;html&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;&lt;a href=&quot;</span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="s1">&quot;&gt;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s1">&lt;/a&gt;&#39;</span>
            <span class="k">elif</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;md&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">elif</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;tex&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">href</span><span class="se">{{</span><span class="si">{</span><span class="n">link</span><span class="si">}</span><span class="se">}}{{</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="n">text</span>

        <span class="c1"># Format the in-text citation</span>
        <span class="n">in_text_citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">)&quot;</span>

        <span class="k">if</span> <span class="n">embed_link</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">doi</span><span class="p">:</span>
                <span class="n">link</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://doi.org/</span><span class="si">{</span><span class="n">doi</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">link</span> <span class="o">=</span> <span class="n">url</span>
            <span class="k">if</span> <span class="n">link</span> <span class="ow">and</span> <span class="n">text_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;html&quot;</span><span class="p">,</span> <span class="s2">&quot;md&quot;</span><span class="p">,</span> <span class="s2">&quot;tex&quot;</span><span class="p">]:</span>
                <span class="n">in_text_citation</span> <span class="o">=</span> <span class="n">embed_link_func</span><span class="p">(</span><span class="n">in_text_citation</span><span class="p">,</span> <span class="n">text_format</span><span class="p">,</span> <span class="n">link</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">in_text_citation</span></div>


<div class="viewcode-block" id="Ref.cite_full">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.cite_full">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">cite_full</span><span class="p">(</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;apa&quot;</span><span class="p">,</span> <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">,</span> <span class="n">entry_type</span><span class="o">=</span><span class="s2">&quot;article&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format a dictionary of bibliometric parameters into a specified citation text_format string and text format.</span>

<span class="sd">        :param bib_dict: dict</span>
<span class="sd">            A dictionary containing bibliometric parameters from a reference.</span>
<span class="sd">            Expected keys vary depending on the bib_dict entry_type.</span>
<span class="sd">        :param style: str</span>
<span class="sd">            The citation text_format to format (e.g., &#39;apa&#39;, &#39;mla&#39;, &#39;chicago&#39;, &#39;harvard&#39;, &#39;vancouver&#39;, &#39;abnt&#39;).</span>
<span class="sd">        :param text_format: str</span>
<span class="sd">            The text format for styling (e.g., &#39;plain&#39;, &#39;html&#39;, &#39;md&#39;, &#39;tex&#39;).</span>
<span class="sd">        :param entry_type: str</span>
<span class="sd">            The entry_type of the BibTeX bib_dict (e.g., &#39;article&#39;, &#39;book&#39;, &#39;inbook&#39;, &#39;incollection&#39;, &#39;proceedings&#39;, &#39;inproceedings&#39;, &#39;conference&#39;, &#39;phdthesis&#39;, &#39;mastersthesis&#39;, &#39;techreport&#39;, &#39;manual&#39;, &#39;unpublished&#39;, &#39;misc&#39;).</span>
<span class="sd">        :return: str</span>
<span class="sd">            The formatted citation string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Using dictionary comprehension</span>
        <span class="n">bib_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="p">(</span><span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

        <span class="c1"># setup variables</span>
        <span class="n">author</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;author&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown Author&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">year</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="s2">&quot;n.d.&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Untitled&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">title</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">):</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">title</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">):</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">title</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">journal</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;journal&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">journal</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">):</span>
            <span class="n">journal</span> <span class="o">=</span> <span class="n">journal</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">journal</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;&quot;&#39;</span><span class="p">):</span>
            <span class="n">journal</span> <span class="o">=</span> <span class="n">journal</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">volume</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">issue</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;issue&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">pages</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pages&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">doi</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;doi&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">booktitle</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;booktitle&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">publisher</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;publisher&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">address</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;address&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">school</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;school&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">rtype</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">institution</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;institution&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">note</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;note&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="c1"># Formatting authors for different styles</span>
        <span class="n">author_list</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)</span>
        <span class="n">formatted_authors</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">author_list</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;, and &quot;</span> <span class="o">+</span> <span class="n">author_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">author_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="k">else</span> <span class="n">author_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># handle special entries</span>
        <span class="k">if</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
            <span class="n">entry_type</span> <span class="o">=</span> <span class="s2">&quot;misc&quot;</span>
            <span class="n">note</span> <span class="o">=</span> <span class="s2">&quot;Dataset&quot;</span>

        <span class="c1"># Apply text formatting</span>
        <span class="k">def</span> <span class="nf">apply_format</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">format_type</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;plain&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">text</span>
            <span class="k">elif</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;html&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">format_type</span> <span class="o">==</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;i&gt;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&lt;/i&gt;&quot;</span>
                <span class="k">elif</span> <span class="n">format_type</span> <span class="o">==</span> <span class="s2">&quot;journal&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;b&gt;</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&lt;/b&gt;&quot;</span>
            <span class="k">elif</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;md&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">format_type</span> <span class="o">==</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;*</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">*&quot;</span>
                <span class="k">elif</span> <span class="n">format_type</span> <span class="o">==</span> <span class="s2">&quot;journal&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;**</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">**&quot;</span>
            <span class="k">elif</span> <span class="n">text_format</span> <span class="o">==</span> <span class="s2">&quot;tex&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">format_type</span> <span class="o">==</span> <span class="s2">&quot;title&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">textit</span><span class="se">{{</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
                <span class="k">elif</span> <span class="n">format_type</span> <span class="o">==</span> <span class="s2">&quot;journal&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">textbf</span><span class="se">{{</span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="n">text</span>

        <span class="n">title</span> <span class="o">=</span> <span class="n">apply_format</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">)</span>
        <span class="n">journal</span> <span class="o">=</span> <span class="n">apply_format</span><span class="p">(</span><span class="n">journal</span><span class="p">,</span> <span class="s2">&quot;journal&quot;</span><span class="p">)</span>

        <span class="c1"># Determine citation format based on bib_dict entry_type and text_format</span>
        <span class="k">if</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;article&quot;</span><span class="p">:</span>
            <span class="n">volume_issue</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">issue</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">if</span> <span class="n">issue</span> <span class="k">else</span> <span class="n">volume</span>
            <span class="n">pages_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;, </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">pages</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="n">doi_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">doi</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">doi</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;apa&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">journal</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">volume_issue</span><span class="si">}{</span><span class="n">pages_str</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">doi_str</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;mla&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s1">. &quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">.&quot; </span><span class="si">{</span><span class="n">journal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">issue</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">): </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s1">. </span><span class="si">{</span><span class="n">doi_str</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;chicago&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s1">. &quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">.&quot; </span><span class="si">{</span><span class="n">journal</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s1">, no. </span><span class="si">{</span><span class="n">issue</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">): </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">doi_str</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;harvard&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">) &#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&#39;, </span><span class="si">{</span><span class="n">journal</span><span class="si">}</span><span class="s2">, vol. </span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2">, no. </span><span class="si">{</span><span class="n">issue</span><span class="si">}</span><span class="s2">, pp. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">doi_str</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;vancouver&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">journal</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">;</span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">issue</span><span class="si">}</span><span class="s2">):</span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">doi_str</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;abnt&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">journal</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2">.(</span><span class="si">{</span><span class="n">issue</span><span class="si">}</span><span class="s2">), p. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">doi_str</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">journal</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">volume_issue</span><span class="si">}{</span><span class="n">pages_str</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">doi_str</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;book&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;apa&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;mla&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;chicago&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;harvard&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">) </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;vancouver&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;abnt&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;inbook&quot;</span> <span class="ow">or</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;incollection&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;apa&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. In </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2"> (Ed.), </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2"> (pp. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;mla&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s1">. &quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">.&quot; </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s1">, edited by </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">, pp. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s1">.&#39;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;chicago&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s1">. &quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">.&quot; In </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s1">, edited by </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s1">. </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">.&#39;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;harvard&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">) &#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&#39;, in </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2"> (ed.), </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">, pp. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;vancouver&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. In: </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2">, editor. </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">. p. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;abnt&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. In: </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2"> (Ed.). </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">. p. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. In </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2"> (Ed.), </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2"> (pp. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">elif</span> <span class="p">(</span>
            <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;proceedings&quot;</span>
            <span class="ow">or</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;inproceedings&quot;</span>
            <span class="ow">or</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;conference&quot;</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;apa&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. In </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2"> (Ed.), </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2"> (pp. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;mla&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s1">. &quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">.&quot; </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">, pp. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s1">.&#39;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;chicago&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s1">. &quot;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s1">.&quot; In </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s1">, edited by </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s1">. </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s1">.&#39;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;harvard&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">) &#39;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&#39;, in </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2"> (ed.), </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">, pp. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;vancouver&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. In: </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2">, editor. </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">. p. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;abnt&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. In: </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2"> (Ed.). </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">. p. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. In </span><span class="si">{</span><span class="n">editor</span><span class="si">}</span><span class="s2"> (Ed.), </span><span class="si">{</span><span class="n">booktitle</span><span class="si">}</span><span class="s2"> (pp. </span><span class="si">{</span><span class="n">pages</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">publisher</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;thesis&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;apa&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">rtype</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">school</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;mla&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">entry_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;thesis&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;thesis&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">school</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;chicago&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">entry_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;thesis&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;thesis&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">school</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;harvard&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">) </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">entry_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;thesis&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;thesis&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">school</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;vancouver&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">entry_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;thesis&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;thesis&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">school</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;abnt&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">school</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> (Unpublished </span><span class="si">{</span><span class="n">entry_type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;thesis&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;thesis&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">school</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;techreport&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;apa&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">institution</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;mla&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">institution</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;chicago&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">institution</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.  </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;harvard&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">) </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">institution</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2">.  </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;vancouver&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">institution</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2">); </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;abnt&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">institution</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">address</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2"> (Technical Report No. </span><span class="si">{</span><span class="n">number</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">institution</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;manual&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;apa&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">organization</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;mla&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">organization</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;chicago&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">organization</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;harvard&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">) </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">organization</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;vancouver&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">organization</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;abnt&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">organization</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">organization</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;unpublished&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;apa&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. Unpublished manuscript.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;mla&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. Unpublished manuscript, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;chicago&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. Unpublished manuscript, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;harvard&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">) </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">, Unpublished manuscript.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;vancouver&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. Unpublished manuscript; </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;abnt&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. Unpublished manuscript, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. Unpublished manuscript.&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;misc&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;apa&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">note</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;mla&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">note</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;chicago&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">note</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;harvard&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">) </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">note</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;vancouver&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">note</span><span class="si">}</span><span class="s2">; </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">elif</span> <span class="n">style</span> <span class="o">==</span> <span class="s2">&quot;abnt&quot;</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">note</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">note</span><span class="si">}</span><span class="s2">.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">citation</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">formatted_authors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year</span><span class="si">}</span><span class="s2">). </span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">. </span><span class="si">{</span><span class="n">journal</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">volume_issue</span><span class="si">}{</span><span class="n">pages_str</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">doi_str</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">citation</span></div>


<div class="viewcode-block" id="Ref.bib_to_str">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.bib_to_str">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">bib_to_str</span><span class="p">(</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">entry_field</span><span class="o">=</span><span class="s2">&quot;entry_type&quot;</span><span class="p">,</span> <span class="n">citation_field</span><span class="o">=</span><span class="s2">&quot;citation_key&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts a dictionary representation of a BibTeX entry into a string.</span>

<span class="sd">        :param bib_dict: The dictionary containing the BibTeX entry data.</span>
<span class="sd">        :type bib_dict: dict</span>
<span class="sd">        :param entry_field: The key for the entry type in the dictionary.</span>
<span class="sd">        :type entry_field: str</span>
<span class="sd">        :param citation_field: The key for the citation key in the dictionary.</span>
<span class="sd">        :type citation_field: str</span>
<span class="sd">        :return: The BibTeX entry as a formatted string.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#</span>
        <span class="n">citation_key</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="p">[</span><span class="n">citation_field</span><span class="p">]</span>

        <span class="c1"># handle special entries</span>
        <span class="k">if</span> <span class="n">bib_dict</span><span class="p">[</span><span class="n">entry_field</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
            <span class="n">bib_dict</span><span class="p">[</span><span class="n">entry_field</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;misc&quot;</span>

        <span class="c1"># list available fields</span>
        <span class="n">bibtex_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="se">{{</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">}}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">entry_field</span><span class="p">,</span> <span class="n">citation_field</span><span class="p">]</span>
        <span class="p">]</span>
        <span class="c1"># build the string</span>
        <span class="n">bibtex_str</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;@</span><span class="si">{</span><span class="n">bib_dict</span><span class="p">[</span><span class="n">entry_field</span><span class="p">]</span><span class="si">}</span><span class="se">{{</span><span class="si">{</span><span class="n">citation_key</span><span class="si">}</span><span class="s2">,</span><span class="se">\n</span><span class="s2">  &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;,</span><span class="se">\n</span><span class="s2">  &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bibtex_fields</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">}&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">bibtex_str</span></div>


<div class="viewcode-block" id="Ref.standard_author">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.standard_author">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">standard_author</span><span class="p">(</span><span class="n">bib_dict</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Formats and standardizes the author names in a BibTeX entry.</span>

<span class="sd">        :param bib_dict: The dictionary containing the BibTeX entry data, expected to have an &#39;author&#39; field.</span>
<span class="sd">        :type bib_dict: dict</span>
<span class="sd">        :return: A formatted string of standardized author names.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">normalize_author_name</span><span class="p">(</span><span class="n">author_name</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">author_name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">author_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">parts</span> <span class="o">=</span> <span class="n">author_name</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">author_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>  <span class="c1"># single filename case (e.g., initials)</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">parts</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="n">standard_authors</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;author&quot;</span> <span class="ow">in</span> <span class="n">bib_dict</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;,&quot;</span> <span class="ow">in</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="s2">&quot; and &quot;</span> <span class="ow">in</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]:</span>
                <span class="n">author_list</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">normalize_author_name</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)</span>
                <span class="p">]</span>
                <span class="n">standard_authors</span> <span class="o">=</span> <span class="s2">&quot; and &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">author_list</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">standard_authors</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">standard_authors</span></div>


<div class="viewcode-block" id="Ref.standard_key">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.standard_key">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">standard_key</span><span class="p">(</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">conflict_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the standard Citation Key in a BibTeX bib_dict dictionary to LastnameFirstAuthor + Year + x (or a, b, c ...)</span>

<span class="sd">        :param bib_dict: dict</span>
<span class="sd">            A dictionary containing bibliometric parameters from a reference.</span>
<span class="sd">            Expected key is &#39;author&#39;, &#39;year&#39; and &#39;title&#39;.</span>
<span class="sd">        :return: str</span>
<span class="sd">            The string with normalized citation key.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">next_available_name</span><span class="p">(</span><span class="n">base_name</span><span class="p">,</span> <span class="n">conflict_names</span><span class="p">):</span>
            <span class="c1"># Initialize the suffix as &#39;a&#39;</span>
            <span class="n">suffix</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>

            <span class="c1"># Generate the name with the current suffix and check for conflicts</span>
            <span class="k">while</span> <span class="n">base_name</span> <span class="o">+</span> <span class="n">suffix</span> <span class="ow">in</span> <span class="n">conflict_names</span><span class="p">:</span>
                <span class="c1"># Move to the next letter in the alphabet</span>
                <span class="n">suffix</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">suffix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

            <span class="c1"># Return the first available name</span>
            <span class="k">return</span> <span class="n">base_name</span> <span class="o">+</span> <span class="n">suffix</span>

        <span class="n">entrytype</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span>
        <span class="n">author</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span>

        <span class="c1"># list of human authors</span>
        <span class="k">if</span> <span class="n">entrytype</span> <span class="o">==</span> <span class="s2">&quot;article&quot;</span> <span class="ow">or</span> <span class="n">entrytype</span> <span class="o">==</span> <span class="s2">&quot;thesis&quot;</span> <span class="ow">or</span> <span class="n">entrytype</span> <span class="o">==</span> <span class="s2">&quot;book&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;and&quot;</span> <span class="ow">in</span> <span class="n">author</span><span class="p">:</span>
                <span class="n">first_author</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">first_author</span> <span class="o">=</span> <span class="n">author</span><span class="p">[:]</span>
            <span class="n">first_name</span> <span class="o">=</span> <span class="n">first_author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="k">elif</span> <span class="s2">&quot; and &quot;</span> <span class="ow">in</span> <span class="n">author</span><span class="p">:</span>
            <span class="n">first_author</span> <span class="o">=</span> <span class="n">author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; and &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">first_name</span> <span class="o">=</span> <span class="n">first_author</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">first_name</span> <span class="o">=</span> <span class="n">author</span><span class="p">[:]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">)</span>

        <span class="c1"># by default set suffix as &#39;a&#39;</span>
        <span class="n">suf</span> <span class="o">=</span> <span class="s2">&quot;a&quot;</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span>
        <span class="n">standard_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">first_name</span><span class="si">}{</span><span class="n">year</span><span class="si">}{</span><span class="n">suf</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="c1"># Check out for conflicting keys</span>
        <span class="k">if</span> <span class="n">conflict_list</span><span class="p">:</span>
            <span class="n">standard_key</span> <span class="o">=</span> <span class="n">next_available_name</span><span class="p">(</span>
                <span class="n">base_name</span><span class="o">=</span><span class="n">standard_key</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">conflict_names</span><span class="o">=</span><span class="n">conflict_list</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">standard_key</span></div>


<div class="viewcode-block" id="Ref.query_doi">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.query_doi">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">query_doi</span><span class="p">(</span><span class="n">doi</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Web query for doi</span>

<span class="sd">        :param doi: reference doi</span>
<span class="sd">        :type doi: str</span>
<span class="sd">        :return: bibtex dict</span>
<span class="sd">        :rtype: dict or None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&gt;&gt;&gt; searching doi </span><span class="si">{</span><span class="n">doi</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Construct the URL to retrieve the citation</span>
        <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://doi.org/</span><span class="si">{</span><span class="n">doi</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># get the citation</span>
            <span class="n">bibtex_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Accept&quot;</span><span class="p">:</span> <span class="s2">&quot;application/x-bibtex&quot;</span><span class="p">}</span>
            <span class="p">)</span>

            <span class="c1"># Check if the request was successful</span>
            <span class="k">if</span> <span class="n">bibtex_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; got doi response&quot;</span><span class="p">)</span>
                <span class="n">bibtex_citation</span> <span class="o">=</span> <span class="n">bibtex_response</span><span class="o">.</span><span class="n">text</span>
                <span class="n">bib_dict</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">bibstr_to_dict</span><span class="p">(</span><span class="n">bibtex_citation</span><span class="p">)</span>
                <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;doi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">doi</span>
                <span class="k">return</span> <span class="n">bib_dict</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The request timed out&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Ref.query_xref">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.query_xref">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">query_xref</span><span class="p">(</span><span class="n">search_query</span><span class="p">,</span> <span class="n">include_refs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Queries a cross-reference service and extracts BibTeX entries from the search results.</span>

<span class="sd">        :param search_query: The query string to search for.</span>
<span class="sd">        :type search_query: str</span>
<span class="sd">        :param include_refs: Whether to include references in the search results.</span>
<span class="sd">        :type include_refs: bool</span>
<span class="sd">        :return: A list of dictionaries containing BibTeX entries.</span>
<span class="sd">        :rtype: list</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">extract_bibtex_entry</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="c1"># Handle authors</span>
            <span class="k">if</span> <span class="s2">&quot;author&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">lst_authors</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">author</span><span class="p">[</span><span class="s1">&#39;family&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">author</span><span class="p">[</span><span class="s1">&#39;given&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">for</span> <span class="n">author</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span>
                <span class="p">]</span>
                <span class="n">authors</span> <span class="o">=</span> <span class="s2">&quot; and &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lst_authors</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">authors</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">bibtex_entry</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;entry_type&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;article&quot;</span>
                <span class="p">),</span>  <span class="c1"># Default to &quot;article&quot; if not specified</span>
                <span class="s2">&quot;author&quot;</span><span class="p">:</span> <span class="n">authors</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span>
                <span class="s2">&quot;journal&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;container-title&quot;</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span>
                <span class="s2">&quot;year&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;published&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;date-parts&quot;</span><span class="p">,</span> <span class="p">[[</span><span class="kc">None</span><span class="p">]])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                <span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">),</span>
                <span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;issue&quot;</span><span class="p">),</span>
                <span class="s2">&quot;pages&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;page&quot;</span><span class="p">),</span>
                <span class="s2">&quot;doi&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;DOI&quot;</span><span class="p">),</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;URL&quot;</span><span class="p">),</span>
                <span class="s2">&quot;publisher&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;publisher&quot;</span><span class="p">),</span>
                <span class="s2">&quot;note&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;note&quot;</span><span class="p">),</span>
                <span class="s2">&quot;abstract&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;abstract&quot;</span><span class="p">),</span>
                <span class="s2">&quot;keywords&quot;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;subject&quot;</span><span class="p">,</span> <span class="p">[]),</span>
            <span class="p">}</span>
            <span class="c1"># Remove None values</span>
            <span class="n">bibtex_entry</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">bibtex_entry</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">}</span>

            <span class="c1"># set citation key and author</span>
            <span class="k">if</span> <span class="s2">&quot;author&quot;</span> <span class="ow">in</span> <span class="n">bibtex_entry</span><span class="p">:</span>
                <span class="n">bibtex_entry</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">standard_author</span><span class="p">(</span><span class="n">bibtex_entry</span><span class="p">)</span>
                <span class="n">bibtex_entry</span><span class="p">[</span><span class="s2">&quot;citation_key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">standard_key</span><span class="p">(</span><span class="n">bibtex_entry</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bibtex_entry</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Unknow&quot;</span>
                <span class="n">bibtex_entry</span><span class="p">[</span><span class="s2">&quot;citation_key&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">bibtex_entry</span><span class="p">[</span><span class="s2">&quot;doi&quot;</span><span class="p">])</span>

            <span class="k">return</span> <span class="n">bibtex_entry</span>

        <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>

            <span class="k">def</span> <span class="nf">find_doi</span><span class="p">(</span><span class="n">citation</span><span class="p">):</span>
                <span class="n">citation_doi</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">lst_uns</span> <span class="o">=</span> <span class="n">citation</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">lst_uns</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;https://doi.org/&quot;</span> <span class="ow">in</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">has_doi</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="n">citation_doi</span> <span class="o">=</span> <span class="n">e</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="s2">&quot;https://doi.org/&quot;</span><span class="p">)</span> <span class="p">:]</span>
                        <span class="k">break</span>
                <span class="k">return</span> <span class="n">citation_doi</span>

            <span class="n">lst_references</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;reference&quot;</span><span class="p">])):</span>

                <span class="c1"># handle DOI</span>
                <span class="k">if</span> <span class="s2">&quot;DOI&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;reference&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">known_doi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;reference&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;DOI&quot;</span><span class="p">]</span>

                <span class="k">elif</span> <span class="s2">&quot;unstructured&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;reference&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="c1"># try to find in the text</span>
                    <span class="n">citation</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;reference&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;unstructured&quot;</span><span class="p">]</span>
                    <span class="n">known_doi</span> <span class="o">=</span> <span class="n">find_doi</span><span class="p">(</span><span class="n">citation</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">known_doi</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="c1"># Handle text</span>
                <span class="k">if</span> <span class="n">known_doi</span><span class="p">:</span>
                    <span class="c1"># print(f&quot;&gt;&gt;&gt;&gt; DOI is known: {known_doi}&quot;)</span>
                    <span class="n">ref_bib_dict</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">query_doi</span><span class="p">(</span><span class="n">doi</span><span class="o">=</span><span class="n">known_doi</span><span class="p">)</span>
                    <span class="c1"># get citation</span>
                    <span class="n">citation_formatted</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">cite_full</span><span class="p">(</span>
                        <span class="n">bib_dict</span><span class="o">=</span><span class="n">ref_bib_dict</span><span class="p">,</span> <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;md&quot;</span>
                    <span class="p">)</span>

                    <span class="c1"># print(f&quot;&gt;&gt;&gt;&gt; {citation_formatted}&quot;)</span>
                    <span class="n">lst_references</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">citation_formatted</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s2">&quot;unstructured&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;reference&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]:</span>
                    <span class="n">citation_formatted</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;reference&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span>
                        <span class="s2">&quot;unstructured&quot;</span>
                    <span class="p">]</span>
                    <span class="n">lst_references</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">citation_formatted</span><span class="p">)</span>

                    <span class="c1"># print(f&quot;&gt;&gt;&gt;&gt; {citation_formatted}&quot;)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="c1"># sort by name</span>
            <span class="n">lst_references</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">lst_references</span>

        <span class="c1"># Generic tool for cross ref API</span>

        <span class="c1"># CrossRef API search URL</span>
        <span class="n">search_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;https://api.crossref.org/works?query.bibliographic=&quot;</span><span class="si">{</span><span class="n">search_query</span><span class="si">}</span><span class="s1">&quot;&amp;rows=2&#39;</span>
        <span class="n">output_data</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">search_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

            <span class="c1"># Handle response</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>  <span class="c1"># json code</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; got response&quot;</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; got data&quot;</span><span class="p">)</span>
                <span class="c1"># handle main bibtex:</span>
                <span class="n">main_bib</span> <span class="o">=</span> <span class="n">extract_bibtex_entry</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="c1"># handle references</span>
                <span class="n">lst_references</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="n">include_refs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s2">&quot;reference&quot;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">lst_references</span> <span class="o">=</span> <span class="n">get_refs</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">lst_references</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="n">output_data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Main&quot;</span><span class="p">:</span> <span class="n">main_bib</span><span class="p">,</span> <span class="s2">&quot;References&quot;</span><span class="p">:</span> <span class="n">lst_references</span><span class="p">}</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">Timeout</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The request timed out&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">output_data</span></div>


<div class="viewcode-block" id="Ref.add">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.add">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">lib_folder</span><span class="p">,</span> <span class="n">file_bib</span><span class="p">,</span> <span class="n">file_pdf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">related</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a reference to the specified library folder.</span>

<span class="sd">        :param lib_folder: The path to the library folder where the reference will be added.</span>
<span class="sd">        :type lib_folder: str</span>
<span class="sd">        :param file_bib: The path to the BibTeX file.</span>
<span class="sd">        :type file_bib: str</span>
<span class="sd">        :param file_pdf: The path to the PDF file, if any.</span>
<span class="sd">        :type file_pdf: str or None</span>
<span class="sd">        :param tags: Optional tags associated with the reference.</span>
<span class="sd">        :type tags: list or None</span>
<span class="sd">        :param related: Optional related references.</span>
<span class="sd">        :type related: list or None</span>
<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">Ref</span><span class="p">()</span>
        <span class="c1"># set parameters</span>
        <span class="n">r</span><span class="o">.</span><span class="n">file_bib</span> <span class="o">=</span> <span class="n">file_bib</span>
        <span class="n">r</span><span class="o">.</span><span class="n">file_doc</span> <span class="o">=</span> <span class="n">file_pdf</span>
        <span class="c1"># load bib</span>
        <span class="n">r</span><span class="o">.</span><span class="n">load_bib</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;article&quot;</span><span class="p">:</span>
            <span class="n">new_tags</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;science&quot;</span><span class="p">,</span> <span class="s2">&quot;paper&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tags</span><span class="p">:</span>
                <span class="n">tags</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">tags</span> <span class="o">+</span> <span class="n">new_tags</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tags</span> <span class="o">=</span> <span class="n">new_tags</span><span class="p">[:]</span>
        <span class="c1"># run</span>
        <span class="n">r</span><span class="o">.</span><span class="n">add_to_lib</span><span class="p">(</span><span class="n">lib_folder</span><span class="o">=</span><span class="n">lib_folder</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">related</span><span class="o">=</span><span class="n">related</span><span class="p">)</span></div>


<div class="viewcode-block" id="Ref.add_bat">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.add_bat">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_bat</span><span class="p">(</span>
        <span class="n">src_folder</span><span class="p">,</span> <span class="n">lib_folder</span><span class="p">,</span> <span class="n">template_folder</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">related</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">clean</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">):</span>

        <span class="c1"># 1) list the pairs of pdfs and bib files</span>
        <span class="n">lst_files</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">catalog_files</span><span class="p">(</span><span class="n">folder_path</span><span class="o">=</span><span class="n">src_folder</span><span class="p">)</span>

        <span class="c1"># 2) for each pair, move it to the library folder</span>
        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">lst_files</span><span class="p">:</span>
            <span class="n">src_bib_file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">src_folder</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">src_pdf_file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">src_folder</span><span class="p">,</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># 3) handle the type of reference</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">Ref</span><span class="p">()</span>
            <span class="n">r</span><span class="o">.</span><span class="n">file_bib</span> <span class="o">=</span> <span class="n">src_bib_file</span>
            <span class="n">r</span><span class="o">.</span><span class="n">file_doc</span> <span class="o">=</span> <span class="n">src_pdf_file</span>
            <span class="n">r</span><span class="o">.</span><span class="n">load_bib</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># always the first</span>

            <span class="c1"># 4) get the note template file</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">RefNote</span><span class="p">()</span>
            <span class="n">note_template_file</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">template_folder</span><span class="p">,</span> <span class="n">n</span><span class="o">.</span><span class="n">template_filenames</span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">entry_type</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="c1"># remove the note object</span>
            <span class="k">del</span> <span class="n">n</span>

            <span class="c1"># 5) call the add to lib</span>
            <span class="n">r</span><span class="o">.</span><span class="n">add_to_lib</span><span class="p">(</span>
                <span class="n">lib_folder</span><span class="o">=</span><span class="n">lib_folder</span><span class="p">,</span>
                <span class="n">note_template</span><span class="o">=</span><span class="n">note_template_file</span><span class="p">,</span>
                <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span>
                <span class="n">related</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">comments</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">pdf_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">note_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># 6) clean-up</span>
            <span class="k">if</span> <span class="n">clean</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">src_bib_file</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">src_pdf_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Ref.catalog_files">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.Ref.catalog_files">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">catalog_files</span><span class="p">(</span><span class="n">folder_path</span><span class="p">):</span>
        <span class="c1"># Get all files in the folder</span>
        <span class="n">all_files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder_path</span><span class="p">)</span>

        <span class="c1"># Separate files by extensions</span>
        <span class="n">bib_files</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">all_files</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.bib&quot;</span><span class="p">))</span>
        <span class="n">pdf_files</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">all_files</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pdf&quot;</span><span class="p">))</span>

        <span class="c1"># Find valid pairs</span>
        <span class="n">valid_pairs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">bib_file</span> <span class="ow">in</span> <span class="n">bib_files</span><span class="p">:</span>
            <span class="c1"># Strip the extension to match file names</span>
            <span class="n">base_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">bib_file</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">pdf_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_name</span><span class="si">}</span><span class="s2">.pdf&quot;</span>

            <span class="c1"># Check if the corresponding PDF exists</span>
            <span class="k">if</span> <span class="n">pdf_file</span> <span class="ow">in</span> <span class="n">pdf_files</span><span class="p">:</span>
                <span class="n">valid_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">bib_file</span><span class="p">,</span> <span class="n">pdf_file</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">valid_pairs</span></div>
</div>



<div class="viewcode-block" id="RefNote">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote">[docs]</a>
<span class="k">class</span> <span class="nc">RefNote</span><span class="p">(</span><span class="n">Note</span><span class="p">):</span>

<div class="viewcode-block" id="RefNote.__init__">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;MyRefNote&quot;</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;RNt1&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">)</span>
        <span class="c1"># ---</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">basic_fields_head</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;entry_type&quot;</span><span class="p">,</span>
            <span class="s2">&quot;citation_key&quot;</span><span class="p">,</span>
            <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span>
            <span class="s2">&quot;author&quot;</span><span class="p">,</span>
            <span class="s2">&quot;year&quot;</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">,</span>
            <span class="s2">&quot;abstract&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">basic_fields_tail</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;url&quot;</span><span class="p">,</span>
            <span class="s2">&quot;credit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;file&quot;</span><span class="p">,</span>  <span class="c1"># todo change and update to &quot;file_pdf&quot;</span>
            <span class="s2">&quot;tags&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="c1"># TEXT FIELD TO AVOID CORRUPTED HEADING BY : OR &quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;article&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;abstract&quot;</span><span class="p">,</span> <span class="s2">&quot;issn&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
            <span class="s2">&quot;book&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;isbn&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;abstract&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
            <span class="s2">&quot;techreport&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;abstract&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
            <span class="s2">&quot;thesis&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;abstract&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
            <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;abstract&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
            <span class="s2">&quot;misc&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;abstract&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="c1"># todo optimize fields using DRY</span>
        <span class="c1"># Expected entries in each kind of reference</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata_entries</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;article&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;doi&quot;</span><span class="p">,</span>
                <span class="s2">&quot;entry_type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_key&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author&quot;</span><span class="p">,</span>
                <span class="s2">&quot;year&quot;</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                <span class="s2">&quot;abstract&quot;</span><span class="p">,</span>
                <span class="s2">&quot;journal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;volume&quot;</span><span class="p">,</span>
                <span class="s2">&quot;number&quot;</span><span class="p">,</span>
                <span class="s2">&quot;pages&quot;</span><span class="p">,</span>
                <span class="s2">&quot;issn&quot;</span><span class="p">,</span>
                <span class="s2">&quot;url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;credit&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tags&quot;</span><span class="p">,</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">&quot;book&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;isbn&quot;</span><span class="p">,</span>
                <span class="s2">&quot;entry_type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_key&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author&quot;</span><span class="p">,</span>
                <span class="s2">&quot;year&quot;</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                <span class="s2">&quot;abstract&quot;</span><span class="p">,</span>
                <span class="s2">&quot;publisher&quot;</span><span class="p">,</span>
                <span class="s2">&quot;url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;credit&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tags&quot;</span><span class="p">,</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">&quot;techreport&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;entry_type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_key&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author&quot;</span><span class="p">,</span>
                <span class="s2">&quot;year&quot;</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                <span class="s2">&quot;abstract&quot;</span><span class="p">,</span>
                <span class="s2">&quot;institution&quot;</span><span class="p">,</span>
                <span class="s2">&quot;address&quot;</span><span class="p">,</span>
                <span class="s2">&quot;number&quot;</span><span class="p">,</span>
                <span class="s2">&quot;isbn&quot;</span><span class="p">,</span>
                <span class="s2">&quot;issn&quot;</span><span class="p">,</span>
                <span class="s2">&quot;url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;credit&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tags&quot;</span><span class="p">,</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="s2">&quot;thesis&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;entry_type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_key&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author&quot;</span><span class="p">,</span>
                <span class="s2">&quot;year&quot;</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                <span class="s2">&quot;abstract&quot;</span><span class="p">,</span>
                <span class="s2">&quot;school&quot;</span><span class="p">,</span>
                <span class="s2">&quot;address&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;credit&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tags&quot;</span><span class="p">,</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="c1"># todo remove dataset entry</span>
            <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;entry_type&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_key&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span>
                <span class="s2">&quot;author&quot;</span><span class="p">,</span>
                <span class="s2">&quot;year&quot;</span><span class="p">,</span>
                <span class="s2">&quot;title&quot;</span><span class="p">,</span>
                <span class="s2">&quot;acronym&quot;</span><span class="p">,</span>
                <span class="s2">&quot;howpublished&quot;</span><span class="p">,</span>
                <span class="s2">&quot;url&quot;</span><span class="p">,</span>
                <span class="s2">&quot;abstract&quot;</span><span class="p">,</span>
                <span class="s2">&quot;website&quot;</span><span class="p">,</span>
                <span class="s2">&quot;x_resolution&quot;</span><span class="p">,</span>
                <span class="s2">&quot;t_resolution&quot;</span><span class="p">,</span>
                <span class="s2">&quot;x_extension&quot;</span><span class="p">,</span>
                <span class="s2">&quot;t_extension&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dataformat&quot;</span><span class="p">,</span>
                <span class="s2">&quot;datacode&quot;</span><span class="p">,</span>
                <span class="s2">&quot;licence&quot;</span><span class="p">,</span>
                <span class="s2">&quot;tags&quot;</span><span class="p">,</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">}</span>

        <span class="c1"># Expected filename for each template:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">template_filenames</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;article&quot;</span><span class="p">:</span> <span class="s2">&quot;_paper.md&quot;</span><span class="p">,</span>
            <span class="s2">&quot;book&quot;</span><span class="p">:</span> <span class="s2">&quot;_book.md&quot;</span><span class="p">,</span>
            <span class="s2">&quot;techreport&quot;</span><span class="p">:</span> <span class="s2">&quot;_techreport.md&quot;</span><span class="p">,</span>
            <span class="s2">&quot;misc&quot;</span><span class="p">:</span> <span class="s2">&quot;_misc.md&quot;</span><span class="p">,</span>
            <span class="s2">&quot;thesis&quot;</span><span class="p">:</span> <span class="s2">&quot;_thesis.md&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="s2">&quot;_dataset.md&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nonbib_fields</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;article&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
            <span class="s2">&quot;book&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
            <span class="s2">&quot;thesis&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
            <span class="s2">&quot;techreport&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">,</span> <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span> <span class="s2">&quot;credit&quot;</span><span class="p">],</span>
            <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;tags&quot;</span><span class="p">,</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">,</span>
                <span class="s2">&quot;file&quot;</span><span class="p">,</span>
                <span class="s2">&quot;citation_in&quot;</span><span class="p">,</span>
                <span class="s2">&quot;acronym&quot;</span><span class="p">,</span>
                <span class="s2">&quot;website&quot;</span><span class="p">,</span>
                <span class="s2">&quot;x_resolution&quot;</span><span class="p">,</span>
                <span class="s2">&quot;t_resolution&quot;</span><span class="p">,</span>
                <span class="s2">&quot;x_extension&quot;</span><span class="p">,</span>
                <span class="s2">&quot;t_extension&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dataformat&quot;</span><span class="p">,</span>
                <span class="s2">&quot;datacode&quot;</span><span class="p">,</span>
                <span class="s2">&quot;licence&quot;</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">}</span></div>


<div class="viewcode-block" id="RefNote.load_metadata">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.load_metadata">[docs]</a>
    <span class="k">def</span> <span class="nf">load_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">load_metadata</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_standardize_metatada</span><span class="p">()</span></div>


<div class="viewcode-block" id="RefNote._standardize_metatada">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote._standardize_metatada">[docs]</a>
    <span class="k">def</span> <span class="nf">_standardize_metatada</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Standardizes the metadata for the current reference.</span>

<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_meta</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># pass</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata_entries</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]]:</span>
            <span class="n">new_meta</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># handle text fields</span>
        <span class="n">ls_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]][:]</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">ls_fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">new_meta</span><span class="p">[</span><span class="n">e</span><span class="p">]:</span>
                <span class="n">new_meta</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">new_meta</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>

        <span class="c1"># set up citation in field</span>
        <span class="n">new_meta</span><span class="p">[</span><span class="s2">&quot;citation_in&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">cite_intext</span><span class="p">(</span><span class="n">bib_dict</span><span class="o">=</span><span class="n">new_meta</span><span class="p">)</span>

        <span class="c1"># special procedures for each datatype</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;article&quot;</span><span class="p">:</span>
            <span class="c1"># handle doi url</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;doi&quot;</span><span class="p">]:</span>
                <span class="n">doi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;doi&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">doi</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;https://doi.org/&quot;</span><span class="p">):</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_meta</span><span class="p">[</span><span class="s2">&quot;doi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;https://doi.org/&quot;</span> <span class="o">+</span> <span class="n">doi</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">new_meta</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>


<div class="viewcode-block" id="RefNote.update_data">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.update_data">[docs]</a>
    <span class="k">def</span> <span class="nf">update_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">related_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates the data structure with the head, body, and tail sections.</span>

<span class="sd">        :param related_list: A list of related entries to include in the body (default is None).</span>
<span class="sd">        :type related_list: list, optional</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_head</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_body</span><span class="p">(</span><span class="n">related_list</span><span class="o">=</span><span class="n">related_list</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_tail</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="RefNote.update_head">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.update_head">[docs]</a>
    <span class="k">def</span> <span class="nf">update_head</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates the head section of the data structure based on the metadata.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">generate_head</span><span class="p">(</span>
            <span class="n">image_name</span><span class="p">,</span>
            <span class="n">title_str</span><span class="p">,</span>
            <span class="n">subtitle</span><span class="p">,</span>
            <span class="n">entry_type</span><span class="p">,</span>
            <span class="n">abstract</span><span class="p">,</span>
            <span class="n">resource</span><span class="p">,</span>
            <span class="n">resource_type</span><span class="o">=</span><span class="s2">&quot;file&quot;</span><span class="p">,</span>
        <span class="p">):</span>
            <span class="k">if</span> <span class="n">resource_type</span> <span class="o">==</span> <span class="s2">&quot;file&quot;</span><span class="p">:</span>
                <span class="n">rcr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;file: [[</span><span class="si">{</span><span class="n">resource</span><span class="si">}</span><span class="s2">.pdf]]&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rcr</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;URL: </span><span class="si">{</span><span class="n">resource</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">return</span> <span class="p">[</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;![[</span><span class="si">{</span><span class="n">image_name</span><span class="si">}</span><span class="s2">.jpg|200]]&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;# </span><span class="si">{</span><span class="n">title_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">entry_type</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;**</span><span class="si">{</span><span class="n">title_str</span><span class="si">}</span><span class="s2">**&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subtitle</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="n">rcr</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&gt; [!Info]+ Abstract&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;&gt; </span><span class="si">{</span><span class="n">abstract</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">]</span>

        <span class="n">bib_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bib_dict</span><span class="p">()</span>
        <span class="n">citation_key</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;citation_key&quot;</span><span class="p">]</span>
        <span class="n">entry_type</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entry_type&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">title_str</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
        <span class="n">citation_in</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">cite_intext</span><span class="p">(</span><span class="n">bib_dict</span><span class="o">=</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;md&quot;</span><span class="p">)</span>
        <span class="n">abs_str</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;abstract&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;abstract&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="k">if</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;article&quot;</span><span class="p">:</span>
            <span class="n">image_name</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;journal&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">journal</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;journal&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;by </span><span class="si">{</span><span class="n">citation_in</span><span class="si">}</span><span class="s2"> in [[</span><span class="si">{</span><span class="n">journal</span><span class="si">}</span><span class="s2">]]&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Head&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_head</span><span class="p">(</span>
                <span class="n">image_name</span><span class="o">=</span><span class="n">image_name</span><span class="p">,</span>
                <span class="n">title_str</span><span class="o">=</span><span class="n">title_str</span><span class="p">,</span>
                <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">,</span>
                <span class="n">entry_type</span><span class="o">=</span><span class="n">entry_type</span><span class="p">,</span>
                <span class="n">abstract</span><span class="o">=</span><span class="n">abs_str</span><span class="p">,</span>
                <span class="n">resource</span><span class="o">=</span><span class="n">citation_key</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;book&quot;</span><span class="p">:</span>
            <span class="n">image_name</span> <span class="o">=</span> <span class="n">title_str</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;by </span><span class="si">{</span><span class="n">citation_in</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Head&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_head</span><span class="p">(</span>
                <span class="n">image_name</span><span class="o">=</span><span class="n">image_name</span><span class="p">,</span>
                <span class="n">title_str</span><span class="o">=</span><span class="n">title_str</span><span class="p">,</span>
                <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">,</span>
                <span class="n">entry_type</span><span class="o">=</span><span class="n">entry_type</span><span class="p">,</span>
                <span class="n">abstract</span><span class="o">=</span><span class="n">abs_str</span><span class="p">,</span>
                <span class="n">resource</span><span class="o">=</span><span class="n">title_str</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;techreport&quot;</span><span class="p">:</span>
            <span class="n">image_name</span> <span class="o">=</span> <span class="n">title_str</span>
            <span class="n">institution</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;institution&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;by </span><span class="si">{</span><span class="n">citation_in</span><span class="si">}</span><span class="s2"> from [[</span><span class="si">{</span><span class="n">institution</span><span class="si">}</span><span class="s2">]]&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Head&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_head</span><span class="p">(</span>
                <span class="n">image_name</span><span class="o">=</span><span class="n">image_name</span><span class="p">,</span>
                <span class="n">title_str</span><span class="o">=</span><span class="n">title_str</span><span class="p">,</span>
                <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">,</span>
                <span class="n">entry_type</span><span class="o">=</span><span class="n">entry_type</span><span class="p">,</span>
                <span class="n">abstract</span><span class="o">=</span><span class="n">abs_str</span><span class="p">,</span>
                <span class="n">resource</span><span class="o">=</span><span class="n">title_str</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;thesis&quot;</span><span class="p">:</span>
            <span class="n">image_name</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;school&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">institution</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;school&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">author_full</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="o">+</span> <span class="s2">&quot; &quot;</span>
                <span class="o">+</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="n">year_str</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">]</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;by [[</span><span class="si">{</span><span class="n">author_full</span><span class="si">}</span><span class="s2">]] (</span><span class="si">{</span><span class="n">year_str</span><span class="si">}</span><span class="s2">) from [[</span><span class="si">{</span><span class="n">institution</span><span class="si">}</span><span class="s2">]]&quot;</span>
            <span class="n">file_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">author_full</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">year_str</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Head&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_head</span><span class="p">(</span>
                <span class="n">image_name</span><span class="o">=</span><span class="n">image_name</span><span class="p">,</span>
                <span class="n">title_str</span><span class="o">=</span><span class="n">title_str</span><span class="p">,</span>
                <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">,</span>
                <span class="n">entry_type</span><span class="o">=</span><span class="n">entry_type</span><span class="p">,</span>
                <span class="n">abstract</span><span class="o">=</span><span class="n">abs_str</span><span class="p">,</span>
                <span class="n">resource</span><span class="o">=</span><span class="n">file_str</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">entry_type</span> <span class="o">==</span> <span class="s2">&quot;dataset&quot;</span><span class="p">:</span>
            <span class="n">subtitle</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;by </span><span class="si">{</span><span class="n">citation_in</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Head&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">generate_head</span><span class="p">(</span>
                <span class="n">image_name</span><span class="o">=</span><span class="n">title_str</span><span class="p">,</span>
                <span class="n">title_str</span><span class="o">=</span><span class="n">title_str</span><span class="p">,</span>
                <span class="n">subtitle</span><span class="o">=</span><span class="n">subtitle</span><span class="p">,</span>
                <span class="n">entry_type</span><span class="o">=</span><span class="n">entry_type</span><span class="p">,</span>
                <span class="n">abstract</span><span class="o">=</span><span class="n">abs_str</span><span class="p">,</span>
                <span class="n">resource</span><span class="o">=</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">],</span>
                <span class="n">resource_type</span><span class="o">=</span><span class="s2">&quot;url&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="RefNote.update_body">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.update_body">[docs]</a>
    <span class="k">def</span> <span class="nf">update_body</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">related_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates the body section of the data structure, including highlights, related entries, and references.</span>

<span class="sd">        :param related_list: A list of related entries to include in the body (default is None).</span>
<span class="sd">        :type related_list: list, optional</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">insert_list_at_flag</span><span class="p">(</span><span class="n">target_list</span><span class="p">,</span> <span class="n">insert_list</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">flag</span> <span class="ow">in</span> <span class="n">target_list</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">target_list</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">target_list</span><span class="p">[:</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">insert_list</span> <span class="o">+</span> <span class="n">target_list</span><span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Flag &#39;</span><span class="si">{</span><span class="n">flag</span><span class="si">}</span><span class="s2">&#39; not found in the target list.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">target_list</span>

        <span class="k">if</span> <span class="s2">&quot;# Overview&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]:</span>
            <span class="n">_ls</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;# Overview&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&gt; [!Abstract]+ Highlights&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&gt; - List highlights&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&gt; [!Example]+ Related&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&gt; - List related&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_ls</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">][:]</span>
        <span class="k">if</span> <span class="s2">&quot;# References&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]:</span>
            <span class="n">_ls</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;# References&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot; - List references&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">][:]</span> <span class="o">+</span> <span class="n">_ls</span>

        <span class="k">if</span> <span class="n">related_list</span><span class="p">:</span>
            <span class="n">insert_ls</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&gt; - </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">related</span><span class="p">)</span> <span class="k">for</span> <span class="n">related</span> <span class="ow">in</span> <span class="n">related_list</span><span class="p">]</span>
            <span class="n">new_body</span> <span class="o">=</span> <span class="n">insert_list_at_flag</span><span class="p">(</span>
                <span class="n">target_list</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">],</span>
                <span class="n">insert_list</span><span class="o">=</span><span class="n">insert_ls</span><span class="p">,</span>
                <span class="n">flag</span><span class="o">=</span><span class="s2">&quot;&gt; [!Example]+ Related&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Body&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_body</span><span class="p">[:]</span>

        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="RefNote.update_tail">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.update_tail">[docs]</a>
    <span class="k">def</span> <span class="nf">update_tail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates the tail section of the data structure with bibliographic information.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">entry_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]</span>
        <span class="n">entry_ls_basic</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;article&quot;</span><span class="p">,</span> <span class="s2">&quot;book&quot;</span><span class="p">,</span> <span class="s2">&quot;techreport&quot;</span><span class="p">,</span> <span class="s2">&quot;thesis&quot;</span><span class="p">,</span> <span class="s2">&quot;dataset&quot;</span><span class="p">,</span> <span class="s2">&quot;misc&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">entry_type</span> <span class="ow">in</span> <span class="n">entry_ls_basic</span><span class="p">:</span>
            <span class="n">bib_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bib_dict</span><span class="p">()</span>
            <span class="n">citation_in</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">cite_intext</span><span class="p">(</span><span class="n">bib_dict</span><span class="o">=</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">)</span>
            <span class="n">citation_fu</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">cite_full</span><span class="p">(</span>
                <span class="n">bib_dict</span><span class="o">=</span><span class="n">bib_dict</span><span class="p">,</span> <span class="n">text_format</span><span class="o">=</span><span class="s2">&quot;plain&quot;</span><span class="p">,</span> <span class="n">entry_type</span><span class="o">=</span><span class="n">entry_type</span>
            <span class="p">)</span>
            <span class="n">bib_str</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">bib_to_str</span><span class="p">(</span><span class="n">bib_dict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_bib_dict</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Tail&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;# Bibliographic information&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;## In-text citation&quot;</span><span class="p">,</span>
                <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                <span class="n">citation_in</span><span class="p">,</span>
                <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;## Full citation&quot;</span><span class="p">,</span>
                <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                <span class="n">citation_fu</span><span class="p">,</span>
                <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;## BibTeX entry&quot;</span><span class="p">,</span>
                <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                <span class="n">bib_str</span><span class="p">,</span>
                <span class="s2">&quot;```&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="RefNote.get_template">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.get_template">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_template</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;bib&quot;</span><span class="p">,</span> <span class="n">head_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;Returns a template dictionary for a given kind of entry.</span>

<span class="sd">        :param kind: The type of template to retrieve (default is &quot;bib&quot;).</span>
<span class="sd">        :type kind: str</span>
<span class="sd">        :param head_name: The header name to use in the template (default is &quot;Header&quot;).</span>
<span class="sd">        :type head_name: str</span>
<span class="sd">        :return: A dictionary containing the template structure.</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">head_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">head_name</span> <span class="o">=</span> <span class="s2">&quot;Header&quot;</span>
        <span class="n">templates</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;bib&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="n">head_name</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;Parent Section&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;Level&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;Content&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;{{LIBRARY ITEM}}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;{{Title}}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;**Summary:** Insert a paragraph comment here</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;related: {{related}}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;file: [[{{file_link}}]]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;## Abstract</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="s2">&quot; &gt; {{abstract}}</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">,</span>
                    <span class="p">],</span>
                <span class="p">},</span>
                <span class="s2">&quot;Comments&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;Parent Section&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;Level&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;Content&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;*Start typing here*</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">---&quot;</span><span class="p">,</span>
                    <span class="p">],</span>
                <span class="p">},</span>
                <span class="s2">&quot;Bibliographic information&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;Parent Section&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="s2">&quot;Level&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="s2">&quot;Content&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;## Citation&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;In-text citation:&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;{{In-text citation}}&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Full citation:&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;{{Full citation}}&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;BibTeX entry:&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;{{BibTeX}}&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;```&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## References&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;{{references}}&quot;</span><span class="p">,</span>
                    <span class="p">],</span>
                <span class="p">},</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">templates</span><span class="p">[</span><span class="n">kind</span><span class="p">]</span></div>


<div class="viewcode-block" id="RefNote.get_bib_dict">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.get_bib_dict">[docs]</a>
    <span class="k">def</span> <span class="nf">get_bib_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a bibdict from the note metadata</span>

<span class="sd">        :return:</span>
<span class="sd">        :rtype: dict</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keys_to_remove</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nonbib_fields</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]]</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys_to_remove</span><span class="p">}</span>
        <span class="c1"># Using dictionary comprehension</span>
        <span class="n">new_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="p">(</span><span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="c1"># handle text fields</span>
        <span class="n">lst_text_fields</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_fields</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">]][:]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">lst_text_fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keys_to_remove</span><span class="p">:</span>
                <span class="n">new_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_dict</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_dict</span></div>


<div class="viewcode-block" id="RefNote.get_bib">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.get_bib">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_bib</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get a bib dictionaty from the content of a RefNote file.</span>
<span class="sd">        The BibTex snippet is expected to exist in the note content</span>

<span class="sd">        :param file_path:</span>
<span class="sd">        :type file_path:</span>
<span class="sd">        :return:</span>
<span class="sd">        :rtype:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

        <span class="n">bibtex_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">entry_type</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">citation_key</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">in_bibtex</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">bibtex_lines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">):</span>
                <span class="n">in_bibtex</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">entry_type</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;{&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">citation_key</span><span class="p">,</span> <span class="n">rest</span> <span class="o">=</span> <span class="n">rest</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">bibtex_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rest</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">in_bibtex</span><span class="p">:</span>
                <span class="n">bibtex_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;}}&quot;</span><span class="p">):</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_bibtex</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">fields_raw</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bibtex_lines</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;}}&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">fields_raw</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;,\s*}&quot;</span><span class="p">,</span> <span class="s2">&quot;}&quot;</span><span class="p">,</span> <span class="n">fields_raw</span><span class="p">)</span>
        <span class="n">fields_raw</span> <span class="o">+=</span> <span class="s2">&quot;,&quot;</span>

        <span class="n">fields_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;(\w+)\s*=\s*\{(.*?)\},&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">fields_pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">fields_raw</span><span class="p">)</span>

        <span class="n">bibtex_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;entry_type&quot;</span><span class="p">:</span> <span class="n">entry_type</span><span class="p">,</span>
            <span class="s2">&quot;citation_key&quot;</span><span class="p">:</span> <span class="n">citation_key</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">field</span>
            <span class="n">bibtex_dict</span><span class="p">[</span><span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">bibtex_dict</span></div>


<div class="viewcode-block" id="RefNote.get_intext_citation">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.get_intext_citation">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_intext_citation</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Extracts the in-text citation from a given file.</span>

<span class="sd">        :param file_path: The path to the file containing the in-text citation.</span>
<span class="sd">        :type file_path: str</span>
<span class="sd">        :return: The extracted in-text citation.</span>
<span class="sd">        :rtype: str</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">content</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="c1"># Regex to find in-text citations and the following code blocks</span>
        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;In-text citation:\n```\n(.*?)\n```&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span><span class="p">)</span>
        <span class="n">matches</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">matches</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="RefNote.get_cover_image">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefNote.get_cover_image">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_cover_image</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
        <span class="kn">import</span> <span class="nn">fitz</span>  <span class="c1"># PyMuPDF</span>
        <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

        <span class="n">d</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">nm</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Open the PDF</span>
        <span class="n">pdf_path</span> <span class="o">=</span> <span class="n">file_path</span><span class="p">[:]</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">fitz</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">)</span>

        <span class="c1"># Render the first page as an image</span>
        <span class="n">page</span> <span class="o">=</span> <span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Get the first page</span>
        <span class="n">pix</span> <span class="o">=</span> <span class="n">page</span><span class="o">.</span><span class="n">get_pixmap</span><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Lower DPI for smaller size</span>

        <span class="c1"># Convert to PIL image</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">frombytes</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">pix</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="n">pix</span><span class="o">.</span><span class="n">height</span><span class="p">],</span> <span class="n">pix</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>

        <span class="c1"># Resize for a smaller image</span>
        <span class="n">image</span><span class="o">.</span><span class="n">thumbnail</span><span class="p">((</span><span class="n">size</span><span class="p">,</span> <span class="n">size</span><span class="p">))</span>

        <span class="c1"># Save as a small-sized JPG</span>
        <span class="n">image_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">nm</span><span class="si">}</span><span class="s2">.jpg&quot;</span>
        <span class="n">image</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">image_file</span><span class="p">,</span> <span class="s2">&quot;JPEG&quot;</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="n">quality</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">image_file</span></div>
</div>



<div class="viewcode-block" id="RefColl">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefColl">[docs]</a>
<span class="k">class</span> <span class="nc">RefColl</span><span class="p">(</span><span class="n">Collection</span><span class="p">):</span>  <span class="c1"># todo docstring</span>

<div class="viewcode-block" id="RefColl.__init__">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefColl.__init__">[docs]</a>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;MyRefCollection&quot;</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="s2">&quot;myRefCol&quot;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">base_object</span><span class="o">=</span><span class="n">Ref</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">alias</span><span class="o">=</span><span class="n">alias</span><span class="p">)</span></div>


<div class="viewcode-block" id="RefColl.load">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefColl.load">[docs]</a>
    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads references from a BibTeX file and appends them to the instance.</span>

<span class="sd">        :param file_path: The path to the BibTeX file.</span>
<span class="sd">        :type file_path: str</span>
<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_refs</span> <span class="o">=</span> <span class="n">Ref</span><span class="o">.</span><span class="n">parse_bibtex</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_refs</span><span class="p">)):</span>
            <span class="n">bib_dict</span> <span class="o">=</span> <span class="n">list_refs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">rf</span> <span class="o">=</span> <span class="n">Ref</span><span class="p">(</span>
                <span class="n">entry_type</span><span class="o">=</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">],</span>
                <span class="n">title</span><span class="o">=</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">],</span>
                <span class="n">author</span><span class="o">=</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">],</span>
                <span class="n">year</span><span class="o">=</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span>
                <span class="n">citation_key</span><span class="o">=</span><span class="n">bib_dict</span><span class="p">[</span><span class="s2">&quot;citation_key&quot;</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="n">rf</span><span class="o">.</span><span class="n">bib_dict</span> <span class="o">=</span> <span class="n">bib_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_object</span><span class="o">=</span><span class="n">rf</span><span class="p">)</span></div>


<div class="viewcode-block" id="RefColl.load_library">
<a class="viewcode-back" href="../../generated/losalamos.refs.html#losalamos.refs.RefColl.load_library">[docs]</a>
    <span class="k">def</span> <span class="nf">load_library</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lib_folder</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="s2">&quot;notes&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; &quot;Loads references from a library folder and appends them to the instance.</span>

<span class="sd">        :param lib_folder: The path to the library folder.</span>
<span class="sd">        :type lib_folder: str</span>
<span class="sd">        :param by: The method to load references by (default is &quot;notes&quot;).</span>
<span class="sd">        :type by: str</span>
<span class="sd">        :return: None</span>
<span class="sd">        :rtype: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">by</span> <span class="o">==</span> <span class="s2">&quot;notes&quot;</span><span class="p">:</span>
            <span class="n">ls_files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lib_folder</span><span class="si">}</span><span class="s2">/*.md&quot;</span><span class="p">)</span>
            <span class="c1"># loop in files</span>
            <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ls_files</span><span class="p">:</span>
                <span class="c1"># Extract BibTeX entry into a dictionary</span>
                <span class="n">bibtex_dict</span> <span class="o">=</span> <span class="n">RefNote</span><span class="o">.</span><span class="n">get_bib</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">Ref</span><span class="p">()</span>
                <span class="n">setter</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">author_field</span><span class="p">:</span> <span class="n">bibtex_dict</span><span class="p">[</span><span class="s2">&quot;author&quot;</span><span class="p">],</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">year_field</span><span class="p">:</span> <span class="n">bibtex_dict</span><span class="p">[</span><span class="s2">&quot;year&quot;</span><span class="p">],</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">type_field</span><span class="p">:</span> <span class="n">bibtex_dict</span><span class="p">[</span><span class="s2">&quot;entry_type&quot;</span><span class="p">],</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">citation_key_field</span><span class="p">:</span> <span class="n">bibtex_dict</span><span class="p">[</span><span class="s2">&quot;citation_key&quot;</span><span class="p">],</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">title_field</span><span class="p">:</span> <span class="n">bibtex_dict</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">],</span>
                <span class="p">}</span>
                <span class="n">r</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">dict_setter</span><span class="o">=</span><span class="n">setter</span><span class="p">)</span>
                <span class="n">r</span><span class="o">.</span><span class="n">bib_dict</span> <span class="o">=</span> <span class="n">bibtex_dict</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">r</span><span class="o">.</span><span class="n">file_note</span> <span class="o">=</span> <span class="n">f</span>
                <span class="n">pdf</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.pdf&quot;</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">pdf</span><span class="p">):</span>
                    <span class="n">r</span><span class="o">.</span><span class="n">file_doc</span> <span class="o">=</span> <span class="n">pdf</span>
                <span class="n">r</span><span class="o">.</span><span class="n">load_note</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_object</span><span class="o">=</span><span class="n">r</span><span class="p">)</span></div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">losalamos v.0.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">losalamos.refs</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, ipo.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>
  </body>
</html>